name: Docker Image CI

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    - name: Build the Docker image
      run: docker build . --file Dockerfile --tag app
    - uses: actions/checkout@v3
    - name: Build the Docker image
      run: docker build . --file Dockerfile_mysql --tag mysql
      
      
    - name: AWS ECR
  # You may pin to the exact commit or the version.
  # uses: kciter/aws-ecr-action@79255b7c5aa03dbf6d7c46cff2bfd049874cd98d
      uses: kciter/aws-ecr-action@v4
      with:
        # The AWS access key id
        access_key_id: ASIAZTVGSY6RYTVEMSG5
        # The AWS secret access key
        secret_access_key: gS2m61P0CkSxxH/L4AM05qbu7FrzYiZOslvLHcNC 
        aws_session_token: FwoGZXIvYXdzEJH//////////wEaDESUwmCMXJ9+260QGSK9AXhWsyoYvEa3Xm2Rg2iwfJPZ/9pBWVIM5GjJnM84G0+WuKJbZmqpoGxM1coOfdVl6k09xWp7Iok45/EBvnkqUBKUHd/4wJb/KMzuRiOxLZ5Hk2GX+D2EWp91r1YupmHXk3/M638OoGoGTQLEJxLMO5EHGRr4AqCWWGdyaGmBp/c7IktdFqKF8gGvCqFbry89EbcOk7OK3Gow72lsEJNdvJQ1wE+/a8Fi9tYTBLQMa+EVGtzBKyTQ/kfoiDYI7iikvNOZBjIt6E0k1C3Csr+nu3xQyWMsGqt/DV+55cmwabNlundnpvjCDVPlGWMqU6fW3fOc
        # Name of your ECR repository
        repo: bar
        # The AWS region
        region: us-east-1
        # Set this to true to create the repository if it does not already exist
        # Set this to true to set a policy on the repository
        # Set this to repository policy statement json file. only used if the set_repo_policy is set to true
        # Comma-separated string of ECR image tags
        # Name of Dockerfile to use
        # Extra flags to pass to docker build (see docs.docker.com/engine/reference/commandline/build)
        # Images to use as cache for the docker build (see `--cache-from` argument docs.docker.com/engine/reference/commandline/build)
        # Path to Dockerfile, defaults to the working directory
        # Relative path from top-level to script to run before Docker build
